"use strict";function showPerformer(e){var n=ejs_no_node.render(PERFORMER_TEMPLATE,{performer:e});$("#performer_info").html(n)}function showEvents(e,n){var t=ejs_no_node.render(EVENTS_TEMPLATE,_.extend({performer:e},n));console.log("contents = "+t),$("#events").html(t)}function addAuthToUrl(e){var n=e;return n+=n.indexOf("?")>=0?"&":"?",n+="client_id=",n+=encodeURIComponent(SEATGEEK_CLIENT_ID)}function fetchEventsForPerformer(e){var n=addAuthToUrl(API_BASE_URL+"events?performers.id="+encodeURIComponent(e.id));$.ajax({url:n,crossDomain:!0,success:function(n){showEvents(e,n)}})}var API_BASE_URL="https://api.seatgeek.com/2/",SEEKGEEK_CLIENT_ID="NjUwMjE1M3wxNDgyNzA5MDQz",PROVIDER_TO_ICON_URL={lastfm:"http://static-web.last.fm/static/images/favicon.702b239b6194.ico",spotify:"https://d2c87l0yth4zbw.global.ssl.fastly.net/i/_global/favicon.ico",musicbrainz:"https://musicbrainz.org/favicon.ico"},PERFORMER_TEMPLATE='\n  <% if (performer.image) { %>\n    <a href="<%= performer.url %>" target="_top">\n      <img id="performer_image" height="150" src="<%= performer.image %>"\n       class="img-rounded">\n    </a>\n  <% } %>\n  <div>\n    <h3 id="performer_name">\n      <%= performer.name %>\n    </h3>\n    <div id="performer_links">\n      <a href="<%= performer.url %>" title="View tickets for <%= performer.name %> on SeatGeek"\n       target="_top">\n        <img src="https://seatgeek.com/favicon.ico" width="32" height="32"\n         alt="SeatGeek">\n      </a>\n\n      <% _(performer.links || []).each(function (link) {\n          var url = link.url;\n          if (link.provider === \'musicbrainz\') {\n            url = \'https://musicbrainz.org/artist/\' + encodeURIComponent(link.id);\n          } %>\n          <a href="<%= url %>" target="_top">\n            <% var iconUrl = PROVIDER_TO_ICON_URL[link.provider];\n               if (iconUrl) { %>\n                 <img src="<%= iconUrl %>" alt="<%= link.provider %>" width="32" height="32">\n            <% } else { %>\n                 <%= link.provider %>\n            <% } %>\n          </a>\n      <% }); %>\n    </div>\n  </div>\n',EVENTS_TEMPLATE='\n  <div id="num_events_found">\n    <%= meta.total %> event<%= (meta.total === 1) ? \'\' : \'s\' %> found:\n  </div>\n  <table class="table table-striped table-condensed">\n    <thead></thead>\n    <tbody>\n    <% _(events).each(function (event) { %>\n      <tr class="event_container">\n        <td>\n          <% if (event.datetime_utc) {\n               var m = moment.utc(event.datetime_utc);\n               m.local();\n          %>\n            <div>\n              <%= m.format(\'ddd, MMM D, YYYY\') %>\n            </div>\n            <div>\n              <%= moment(event.datetime_local).format(\'h:mm a\') %>\n            </div>\n          <% } %>\n        </td>\n        <td>\n          <div class="event_title">\n            <a href="<%= event.url %>" target="_top"><%= event.title %></a>\n          </div>\n          <% if (event.venue) { v = event.venue; %>\n            <div>\n              <%= v.display_location %>\n              <% if (v.name) { %>\n                (<%= v.name %>)\n              <% } %>\n            </div>\n          <% } %>\n        </td>\n      </tr>\n  <% }); %>\n    </tbody>\n  </table>\n  <% var remainingEvents = meta.total - events.length;\n     if (remainingEvents > 0) { %>\n       <p>\n        See <%= remainingEvents %> more event<%= (remainingEvents === 1) ? \'\' : \'s\' %>\n        at <a href="<%= performer.url %>" title="More events" target="_top">SeatGeek</a>\n      </p>\n  <% } %>\n';$(function(){var e=$("#data_to_transfer").attr("data-performer"),n=addAuthToUrl(API_BASE_URL+"performers?q="+encodeURIComponent(e));$.ajax({url:n,crossDomain:!0,success:function(e){var n=e.performers;if(0===n.length)$("#performer_info").text("No performers found on SeatGeek.");else{var t=n[0];showPerformer(t),t.has_upcoming_events?fetchEventsForPerformer(t):$("#events").text("No upcoming events found.")}}})});